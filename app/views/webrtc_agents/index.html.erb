<div class="container">
  <div class="row">
    <div class="col-md-4">
      <p>    
        <!-- <button type="button" class="btn btn-primary" onclick="window.location.href='/createacl'">Create ACL</button>
        <button type="button" class="btn btn-primary" onclick="window.location.href='/createipcl'">Create IPACL</button> -->
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">
          <%=@ip_acl_label %>
        </button>

        <!-- Modal -->
        <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Modal title</h4>
              </div>
              <div class="modal-body">
                 <form>
                    <div class="form-group col-md-6">
                      <label for="exampleInputEmail1">Friendly Name</label>
                      <input type="name" class="form-control" id="FN1" placeholder="Friendly Name">
                      <input type="name" class="form-control" id="FN1" placeholder="Friendly Name">
                      <input type="name" class="form-control" id="FN1" placeholder="Friendly Name">
                      <input type="name" class="form-control" id="FN1" placeholder="Friendly Name">
                      <input type="name" class="form-control" id="FN1" placeholder="Friendly Name">
                    </div>
                    <div class="form-group col-md-6">
                      <label for="exampleInputPassword1">IP Address</label>
                      <input type="ip" class="form-control" id="exampleInputPassword1" placeholder="192.168.2.1">
                      <input type="ip" class="form-control" id="exampleInputPassword1" placeholder="192.168.2.1">
                      <input type="ip" class="form-control" id="exampleInputPassword1" placeholder="192.168.2.1">
                      <input type="ip" class="form-control" id="exampleInputPassword1" placeholder="192.168.2.1">
                      <input type="ip" class="form-control" id="exampleInputPassword1" placeholder="192.168.2.1">
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
              </div>
            </div>
          </div>
        </div>
                <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal2">
          <%=@acl_label%>
        </button>

        <!-- Modal -->
        <div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Modal title</h4>
              </div>
              <div class="modal-body">
               <form>
                <div class="form-group">
                  <label for="exampleInputEmail1">Email address</label>
                  <input type="email" class="form-control" id="exampleInputEmail1" placeholder="Enter email">
                </div>
                <div class="form-group">
                  <label for="exampleInputPassword1">Password</label>
                  <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
                </div>
                <div class="form-group">
                  <label for="exampleInputFile">File input</label>
                  <input type="file" id="exampleInputFile">
                  <p class="help-block">Example block-level help text here.</p>
                </div>
                <div class="checkbox">
                  <label>
                    <input type="checkbox"> Check me out
                  </label>
                </div>
                <button type="submit" class="btn btn-default">Submit</button>
              </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
              </div>
            </div>
          </div>
        </div>
        <%= @domain%>
      </p>
    </div>
    <div class="col-md-4">
      <div class="well well-lg">
        <div class="btn-group" role="group" aria-label="...">
          <button type="button" class="btn btn-success" onclick="accept();">
            Accept
          </button>
          <button type="button" class="btn btn-danger" onclick="hangup();">
            Hangup
          </button>
          <button id="mute-btn" type="button" class="btn btn-default" onclick="mute();">
            Mute
          </button>
        </div>
        <div class="panel-body" id="log" >Connecting to Twilio...</div>
      </div>
    </div>
    <div class="col-md-4">
      <p><%= @number%></p>
    </div>
  </div>
</div>

<script type="text/javascript"
  src="//static.twilio.com/libs/twiliojs/1.2/twilio.min.js">
</script>


<script type="text/javascript">

/* Create the Client with a Capability Token */

$( document ).ready(function() {
    Twilio.Device.setup("<%= @token %>", {debug: true});
  });

  /* Let us know when the client is ready. */
  Twilio.Device.ready(function (device) {
    $("#log").text("Client is ready ");
  });
 
  /* Report any errors on the screen */
  Twilio.Device.error(function (error) {
    $("#log").text("Error: " + error.message);
  });
 
  Twilio.Device.connect(function (conn) {
    $("#log").text("SID:  " +  conn.parameters.CallSid);
  });
  
  Twilio.Device.disconnect(function (conn) {
    $("#log").text("Call ended");
  });

  Twilio.Device.incoming(function (conn) {
    $("#log").text("Incoming connection from " + conn.parameters.From);
  });

  function hangup() {
    Twilio.Device.disconnectAll();
  }

  function accept() {
    Twilio.Device.activeConnection().accept();
    $("#log").text("Connection active");
  }
//TODO implement mute
  // function mute() {
  //   if (Twilio.Device.activeConnection().isMuted() == false) {
  //   Twilio.Device.activeConnection().mute(true);
  // }
  //   else { if (Twilio.Device.activeConnection().isMuted() == true)
  //     Twilio.Device.activeConnection().mute(false);
  //   else alert("hi");}
  // }

  </script>